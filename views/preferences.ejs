<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preferences - Only Good News</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <header>
        <nav>
            <div class="nav-left">
                <a href="/">Only Good News</a>
                <a href="/saved">Saved Articles</a>
                <a href="/preferences">Preferences</a>
                <% if (isAdmin) { %>
                    <a href="/admin/users">Manage Users</a>
                <% } %>
            </div>
            <div class="nav-right">
                <% if (username) { %>
                    <span class="nav-user">Signed in as <%= username %></span>
                    <form action="/logout" method="POST">
                        <button type="submit" class="btn subtle">Logout</button>
                    </form>
                <% } else { %>
                    <a href="/login">Login</a>
                    <a class="btn primary" href="/signup">Sign up</a>
                <% } %>
            </div>
        </nav>
    </header>
    <main class="container">
        <div class="card preferences-card">
            <div class="preferences-header">
                <h1>Your News Preferences</h1>
                <p class="muted">Choose up to 3 categories to personalize your news feed. Your first preference will be used to filter articles.</p>
            </div>

            <% if (error) { %>
                <div class="alert error"><%= error %></div>
            <% } %>

            <% if (success) { %>
                <div class="alert success"><%= success %></div>
            <% } %>

            <%
                const categories = [
                    'Arts, Culture and Entertainment',
                    'Crime, Law and Justice',
                    'Disaster and Accident',
                    'Economy, Business and Finance',
                    'Education',
                    'Environment',
                    'Health',
                    'Human Interest',
                    'Labor',
                    'Lifestyle and Leisure',
                    'Politics',
                    'Religion and Belief',
                    'Science and Technology',
                    'Social Issue',
                    'Sport',
                    'War, Conflict and Unrest',
                    'Weather'
                ];
            %>

            <form action="/preferences" method="POST" class="preferences-form">
                <div class="form-group">
                    <label for="preference_one">Preference 1 (Primary)</label>
                    <select id="preference_one" name="preference_one">
                        <option value="">-- Select a category --</option>
                        <% categories.forEach(cat => { %>
                            <option value="<%= cat %>" <%= values.preference_one === cat ? 'selected' : '' %>><%= cat %></option>
                        <% }); %>
                    </select>
                    <p class="muted small">This is the category used to filter your news feed.</p>
                </div>

                <div class="form-group">
                    <label for="preference_two">Preference 2</label>
                    <select id="preference_two" name="preference_two">
                        <option value="">-- Select a category --</option>
                        <% categories.forEach(cat => { %>
                            <option value="<%= cat %>" <%= values.preference_two === cat ? 'selected' : '' %>><%= cat %></option>
                        <% }); %>
                    </select>
                </div>

                <div class="form-group">
                    <label for="preference_three">Preference 3</label>
                    <select id="preference_three" name="preference_three">
                        <option value="">-- Select a category --</option>
                        <% categories.forEach(cat => { %>
                            <option value="<%= cat %>" <%= values.preference_three === cat ? 'selected' : '' %>><%= cat %></option>
                        <% }); %>
                    </select>
                </div>

                <div class="preferences-actions">
                    <button type="submit" class="btn primary">Save Preferences</button>
                    <a href="/" class="btn">‚Üê Back to News</a>
                </div>
            </form>
        </div>
    </main>
</body>
</html>
